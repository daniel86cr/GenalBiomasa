<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dina.genasoft.db.mapper.TCompras2030Mapper">
  <!--  <cache eviction="LRU" readOnly="true" size="9999999" />  -->
  <resultMap id="BaseResultMap" type="com.dina.genasoft.db.entity.TCompras2030">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="id_externo" jdbcType="DOUBLE" property="idExterno" />
    <result column="albaran" jdbcType="VARCHAR" property="albaran" />
    <result column="albaran_fin" jdbcType="VARCHAR" property="albaranFin" />
    <result column="lote" jdbcType="VARCHAR" property="lote" />
    <result column="nombre_descriptivo" jdbcType="VARCHAR" property="nombreDescriptivo" />
    <result column="lote_fin" jdbcType="VARCHAR" property="loteFin" />
    <result column="partida" jdbcType="VARCHAR" property="partida" />
    <result column="partida_fin" jdbcType="VARCHAR" property="partidaFin" />
    <result column="fecha" jdbcType="DATE" property="fecha" />
    <result column="fecha_fin" jdbcType="DATE" property="fechaFin" />
    <result column="centro" jdbcType="VARCHAR" property="centro" />
    <result column="centro_fin" jdbcType="VARCHAR" property="centroFin" />
    <result column="cajas" jdbcType="INTEGER" property="cajas" />
    <result column="cajas_fin" jdbcType="INTEGER" property="cajasFin" />
    <result column="kgs_bruto" jdbcType="DOUBLE" property="kgsBruto" />
    <result column="kgs_bruto_fin" jdbcType="DOUBLE" property="kgsBrutoFin" />
    <result column="tipo_compra" jdbcType="VARCHAR" property="tipoCompra" />
    <result column="tipo_compra_fin" jdbcType="VARCHAR" property="tipoCompraFin" />
    <result column="fecha_calibrado" jdbcType="TIMESTAMP" property="fechaCalibrado" />
    <result column="fecha_calibrado_fin" jdbcType="TIMESTAMP" property="fechaCalibradoFin" />
    <result column="peso_neto" jdbcType="DOUBLE" property="pesoNeto" />
    <result column="peso_neto_fin" jdbcType="DOUBLE" property="pesoNetoFin" />
    <result column="peso_neto_disponible" jdbcType="DOUBLE" property="pesoNetoDisponible" />
    <result column="tara" jdbcType="DOUBLE" property="tara" />
    <result column="tara_fin" jdbcType="DOUBLE" property="taraFin" />
    <result column="finca" jdbcType="VARCHAR" property="finca" />
    <result column="finca_fin" jdbcType="VARCHAR" property="fincaFin" />
    <result column="producto" jdbcType="VARCHAR" property="producto" />
    <result column="producto_fin" jdbcType="VARCHAR" property="productoFin" />
    <result column="proveedor" jdbcType="VARCHAR" property="proveedor" />
    <result column="proveedor_fin" jdbcType="VARCHAR" property="proveedorFin" />
    <result column="notas_calidad" jdbcType="VARCHAR" property="notasCalidad" />
    <result column="notas_calidad_fin" jdbcType="VARCHAR" property="notasCalidadFin" />
    <result column="origen" jdbcType="VARCHAR" property="origen" />
    <result column="origen_fin" jdbcType="VARCHAR" property="origenFin" />
    <result column="familia" jdbcType="VARCHAR" property="familia" />
    <result column="familia_fin" jdbcType="VARCHAR" property="familiaFin" />
    <result column="calidad" jdbcType="VARCHAR" property="calidad" />
    <result column="calidad_fin" jdbcType="VARCHAR" property="calidadFin" />
    <result column="variedad" jdbcType="VARCHAR" property="variedad" />
    <result column="variedad_fin" jdbcType="VARCHAR" property="variedadFin" />
    <result column="usu_crea" jdbcType="INTEGER" property="usuCrea" />
    <result column="fecha_crea" jdbcType="TIMESTAMP" property="fechaCrea" />
    <result column="ggn" jdbcType="VARCHAR" property="ggn" />
    <result column="ggn_fin" jdbcType="VARCHAR" property="ggnFin" />
    <result column="cerrada" jdbcType="INTEGER" property="cerrada" />
    <result column="calibre" jdbcType="VARCHAR" property="calibre" />
    <result column="calibre_fin" jdbcType="VARCHAR" property="calibreFin" />
  </resultMap>
  <resultMap id="BaseResultMap2" type="com.dina.genasoft.db.entity.TCompras">
    <!--
      
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="id_externo" jdbcType="DOUBLE" property="idExterno" />
    <result column="albaran" jdbcType="VARCHAR" property="albaran" />
    <result column="albaran_fin" jdbcType="VARCHAR" property="albaranFin" />
    <result column="lote" jdbcType="VARCHAR" property="lote" />
    <result column="nombre_descriptivo" jdbcType="VARCHAR" property="nombreDescriptivo" />
    <result column="lote_fin" jdbcType="VARCHAR" property="loteFin" />
    <result column="partida" jdbcType="VARCHAR" property="partida" />
    <result column="partida_fin" jdbcType="VARCHAR" property="partidaFin" />
    <result column="fecha" jdbcType="DATE" property="fecha" />
    <result column="fecha_fin" jdbcType="DATE" property="fechaFin" />
    <result column="centro" jdbcType="VARCHAR" property="centro" />
    <result column="centro_fin" jdbcType="VARCHAR" property="centroFin" />
    <result column="cajas" jdbcType="INTEGER" property="cajas" />
    <result column="cajas_fin" jdbcType="INTEGER" property="cajasFin" />
    <result column="kgs_bruto" jdbcType="DOUBLE" property="kgsBruto" />
    <result column="kgs_bruto_fin" jdbcType="DOUBLE" property="kgsBrutoFin" />
    <result column="tipo_compra" jdbcType="VARCHAR" property="tipoCompra" />
    <result column="tipo_compra_fin" jdbcType="VARCHAR" property="tipoCompraFin" />
    <result column="fecha_calibrado" jdbcType="TIMESTAMP" property="fechaCalibrado" />
    <result column="fecha_calibrado_fin" jdbcType="TIMESTAMP" property="fechaCalibradoFin" />
    <result column="peso_neto" jdbcType="DOUBLE" property="pesoNeto" />
    <result column="peso_neto_fin" jdbcType="DOUBLE" property="pesoNetoFin" />
    <result column="peso_neto_disponible" jdbcType="DOUBLE" property="pesoNetoDisponible" />
    <result column="tara" jdbcType="DOUBLE" property="tara" />
    <result column="tara_fin" jdbcType="DOUBLE" property="taraFin" />
    <result column="finca" jdbcType="VARCHAR" property="finca" />
    <result column="finca_fin" jdbcType="VARCHAR" property="fincaFin" />
    <result column="producto" jdbcType="VARCHAR" property="producto" />
    <result column="producto_fin" jdbcType="VARCHAR" property="productoFin" />
    <result column="proveedor" jdbcType="VARCHAR" property="proveedor" />
    <result column="proveedor_fin" jdbcType="VARCHAR" property="proveedorFin" />
    <result column="notas_calidad" jdbcType="VARCHAR" property="notasCalidad" />
    <result column="notas_calidad_fin" jdbcType="VARCHAR" property="notasCalidadFin" />
    <result column="origen" jdbcType="VARCHAR" property="origen" />
    <result column="origen_fin" jdbcType="VARCHAR" property="origenFin" />
    <result column="familia" jdbcType="VARCHAR" property="familia" />
    <result column="familia_fin" jdbcType="VARCHAR" property="familiaFin" />
    <result column="calidad" jdbcType="VARCHAR" property="calidad" />
    <result column="calidad_fin" jdbcType="VARCHAR" property="calidadFin" />
    <result column="variedad" jdbcType="VARCHAR" property="variedad" />
    <result column="variedad_fin" jdbcType="VARCHAR" property="variedadFin" />
    <result column="usu_crea" jdbcType="INTEGER" property="usuCrea" />
    <result column="fecha_crea" jdbcType="TIMESTAMP" property="fechaCrea" />
    <result column="ggn" jdbcType="VARCHAR" property="ggn" />
    <result column="ggn_fin" jdbcType="VARCHAR" property="ggnFin" />
    <result column="cerrada" jdbcType="INTEGER" property="cerrada" />
    <result column="calibre" jdbcType="VARCHAR" property="calibre" />
    <result column="calibre_fin" jdbcType="VARCHAR" property="calibreFin" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    id, id_externo, albaran, albaran_fin, lote, nombre_descriptivo, lote_fin, partida, 
    partida_fin, fecha, fecha_fin, centro, centro_fin, cajas, cajas_fin, kgs_bruto, kgs_bruto_fin, 
    tipo_compra, tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, peso_neto, peso_neto_fin, 
    peso_neto_disponible, tara, tara_fin, finca, finca_fin, producto, producto_fin, proveedor, 
    proveedor_fin, notas_calidad, notas_calidad_fin, origen, origen_fin, familia, familia_fin, 
    calidad, calidad_fin, variedad, variedad_fin, usu_crea, fecha_crea, ggn, ggn_fin, 
    cerrada, calibre, calibre_fin
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where id = #{id,jdbcType=INTEGER}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    delete from t_compras_2030
    where id = #{id,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.dina.genasoft.db.entity.TCompras2030">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    insert into t_compras_2030 (id, id_externo, albaran, 
      albaran_fin, lote, nombre_descriptivo, 
      lote_fin, partida, partida_fin, 
      fecha, fecha_fin, centro, 
      centro_fin, cajas, cajas_fin, 
      kgs_bruto, kgs_bruto_fin, tipo_compra, 
      tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, 
      peso_neto, peso_neto_fin, peso_neto_disponible, 
      tara, tara_fin, finca, 
      finca_fin, producto, producto_fin, 
      proveedor, proveedor_fin, notas_calidad, 
      notas_calidad_fin, origen, origen_fin, 
      familia, familia_fin, calidad, 
      calidad_fin, variedad, variedad_fin, 
      usu_crea, fecha_crea, ggn, 
      ggn_fin, cerrada, calibre, 
      calibre_fin)
    values (#{id,jdbcType=INTEGER}, #{idExterno,jdbcType=DOUBLE}, #{albaran,jdbcType=VARCHAR}, 
      #{albaranFin,jdbcType=VARCHAR}, #{lote,jdbcType=VARCHAR}, #{nombreDescriptivo,jdbcType=VARCHAR}, 
      #{loteFin,jdbcType=VARCHAR}, #{partida,jdbcType=VARCHAR}, #{partidaFin,jdbcType=VARCHAR}, 
      #{fecha,jdbcType=DATE}, #{fechaFin,jdbcType=DATE}, #{centro,jdbcType=VARCHAR}, 
      #{centroFin,jdbcType=VARCHAR}, #{cajas,jdbcType=INTEGER}, #{cajasFin,jdbcType=INTEGER}, 
      #{kgsBruto,jdbcType=DOUBLE}, #{kgsBrutoFin,jdbcType=DOUBLE}, #{tipoCompra,jdbcType=VARCHAR}, 
      #{tipoCompraFin,jdbcType=VARCHAR}, #{fechaCalibrado,jdbcType=TIMESTAMP}, #{fechaCalibradoFin,jdbcType=TIMESTAMP}, 
      #{pesoNeto,jdbcType=DOUBLE}, #{pesoNetoFin,jdbcType=DOUBLE}, #{pesoNetoDisponible,jdbcType=DOUBLE}, 
      #{tara,jdbcType=DOUBLE}, #{taraFin,jdbcType=DOUBLE}, #{finca,jdbcType=VARCHAR}, 
      #{fincaFin,jdbcType=VARCHAR}, #{producto,jdbcType=VARCHAR}, #{productoFin,jdbcType=VARCHAR}, 
      #{proveedor,jdbcType=VARCHAR}, #{proveedorFin,jdbcType=VARCHAR}, #{notasCalidad,jdbcType=VARCHAR}, 
      #{notasCalidadFin,jdbcType=VARCHAR}, #{origen,jdbcType=VARCHAR}, #{origenFin,jdbcType=VARCHAR}, 
      #{familia,jdbcType=VARCHAR}, #{familiaFin,jdbcType=VARCHAR}, #{calidad,jdbcType=VARCHAR}, 
      #{calidadFin,jdbcType=VARCHAR}, #{variedad,jdbcType=VARCHAR}, #{variedadFin,jdbcType=VARCHAR}, 
      #{usuCrea,jdbcType=INTEGER}, #{fechaCrea,jdbcType=TIMESTAMP}, #{ggn,jdbcType=VARCHAR}, 
      #{ggnFin,jdbcType=VARCHAR}, #{cerrada,jdbcType=INTEGER}, #{calibre,jdbcType=VARCHAR}, 
      #{calibreFin,jdbcType=VARCHAR})
  </insert>
  <insert id="insertSelective" parameterType="com.dina.genasoft.db.entity.TCompras2030">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    insert into t_compras_2030
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="idExterno != null">
        id_externo,
      </if>
      <if test="albaran != null">
        albaran,
      </if>
      <if test="albaranFin != null">
        albaran_fin,
      </if>
      <if test="lote != null">
        lote,
      </if>
      <if test="nombreDescriptivo != null">
        nombre_descriptivo,
      </if>
      <if test="loteFin != null">
        lote_fin,
      </if>
      <if test="partida != null">
        partida,
      </if>
      <if test="partidaFin != null">
        partida_fin,
      </if>
      <if test="fecha != null">
        fecha,
      </if>
      <if test="fechaFin != null">
        fecha_fin,
      </if>
      <if test="centro != null">
        centro,
      </if>
      <if test="centroFin != null">
        centro_fin,
      </if>
      <if test="cajas != null">
        cajas,
      </if>
      <if test="cajasFin != null">
        cajas_fin,
      </if>
      <if test="kgsBruto != null">
        kgs_bruto,
      </if>
      <if test="kgsBrutoFin != null">
        kgs_bruto_fin,
      </if>
      <if test="tipoCompra != null">
        tipo_compra,
      </if>
      <if test="tipoCompraFin != null">
        tipo_compra_fin,
      </if>
      <if test="fechaCalibrado != null">
        fecha_calibrado,
      </if>
      <if test="fechaCalibradoFin != null">
        fecha_calibrado_fin,
      </if>
      <if test="pesoNeto != null">
        peso_neto,
      </if>
      <if test="pesoNetoFin != null">
        peso_neto_fin,
      </if>
      <if test="pesoNetoDisponible != null">
        peso_neto_disponible,
      </if>
      <if test="tara != null">
        tara,
      </if>
      <if test="taraFin != null">
        tara_fin,
      </if>
      <if test="finca != null">
        finca,
      </if>
      <if test="fincaFin != null">
        finca_fin,
      </if>
      <if test="producto != null">
        producto,
      </if>
      <if test="productoFin != null">
        producto_fin,
      </if>
      <if test="proveedor != null">
        proveedor,
      </if>
      <if test="proveedorFin != null">
        proveedor_fin,
      </if>
      <if test="notasCalidad != null">
        notas_calidad,
      </if>
      <if test="notasCalidadFin != null">
        notas_calidad_fin,
      </if>
      <if test="origen != null">
        origen,
      </if>
      <if test="origenFin != null">
        origen_fin,
      </if>
      <if test="familia != null">
        familia,
      </if>
      <if test="familiaFin != null">
        familia_fin,
      </if>
      <if test="calidad != null">
        calidad,
      </if>
      <if test="calidadFin != null">
        calidad_fin,
      </if>
      <if test="variedad != null">
        variedad,
      </if>
      <if test="variedadFin != null">
        variedad_fin,
      </if>
      <if test="usuCrea != null">
        usu_crea,
      </if>
      <if test="fechaCrea != null">
        fecha_crea,
      </if>
      <if test="ggn != null">
        ggn,
      </if>
      <if test="ggnFin != null">
        ggn_fin,
      </if>
      <if test="cerrada != null">
        cerrada,
      </if>
      <if test="calibre != null">
        calibre,
      </if>
      <if test="calibreFin != null">
        calibre_fin,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=INTEGER},
      </if>
      <if test="idExterno != null">
        #{idExterno,jdbcType=DOUBLE},
      </if>
      <if test="albaran != null">
        #{albaran,jdbcType=VARCHAR},
      </if>
      <if test="albaranFin != null">
        #{albaranFin,jdbcType=VARCHAR},
      </if>
      <if test="lote != null">
        #{lote,jdbcType=VARCHAR},
      </if>
      <if test="nombreDescriptivo != null">
        #{nombreDescriptivo,jdbcType=VARCHAR},
      </if>
      <if test="loteFin != null">
        #{loteFin,jdbcType=VARCHAR},
      </if>
      <if test="partida != null">
        #{partida,jdbcType=VARCHAR},
      </if>
      <if test="partidaFin != null">
        #{partidaFin,jdbcType=VARCHAR},
      </if>
      <if test="fecha != null">
        #{fecha,jdbcType=DATE},
      </if>
      <if test="fechaFin != null">
        #{fechaFin,jdbcType=DATE},
      </if>
      <if test="centro != null">
        #{centro,jdbcType=VARCHAR},
      </if>
      <if test="centroFin != null">
        #{centroFin,jdbcType=VARCHAR},
      </if>
      <if test="cajas != null">
        #{cajas,jdbcType=INTEGER},
      </if>
      <if test="cajasFin != null">
        #{cajasFin,jdbcType=INTEGER},
      </if>
      <if test="kgsBruto != null">
        #{kgsBruto,jdbcType=DOUBLE},
      </if>
      <if test="kgsBrutoFin != null">
        #{kgsBrutoFin,jdbcType=DOUBLE},
      </if>
      <if test="tipoCompra != null">
        #{tipoCompra,jdbcType=VARCHAR},
      </if>
      <if test="tipoCompraFin != null">
        #{tipoCompraFin,jdbcType=VARCHAR},
      </if>
      <if test="fechaCalibrado != null">
        #{fechaCalibrado,jdbcType=TIMESTAMP},
      </if>
      <if test="fechaCalibradoFin != null">
        #{fechaCalibradoFin,jdbcType=TIMESTAMP},
      </if>
      <if test="pesoNeto != null">
        #{pesoNeto,jdbcType=DOUBLE},
      </if>
      <if test="pesoNetoFin != null">
        #{pesoNetoFin,jdbcType=DOUBLE},
      </if>
      <if test="pesoNetoDisponible != null">
        #{pesoNetoDisponible,jdbcType=DOUBLE},
      </if>
      <if test="tara != null">
        #{tara,jdbcType=DOUBLE},
      </if>
      <if test="taraFin != null">
        #{taraFin,jdbcType=DOUBLE},
      </if>
      <if test="finca != null">
        #{finca,jdbcType=VARCHAR},
      </if>
      <if test="fincaFin != null">
        #{fincaFin,jdbcType=VARCHAR},
      </if>
      <if test="producto != null">
        #{producto,jdbcType=VARCHAR},
      </if>
      <if test="productoFin != null">
        #{productoFin,jdbcType=VARCHAR},
      </if>
      <if test="proveedor != null">
        #{proveedor,jdbcType=VARCHAR},
      </if>
      <if test="proveedorFin != null">
        #{proveedorFin,jdbcType=VARCHAR},
      </if>
      <if test="notasCalidad != null">
        #{notasCalidad,jdbcType=VARCHAR},
      </if>
      <if test="notasCalidadFin != null">
        #{notasCalidadFin,jdbcType=VARCHAR},
      </if>
      <if test="origen != null">
        #{origen,jdbcType=VARCHAR},
      </if>
      <if test="origenFin != null">
        #{origenFin,jdbcType=VARCHAR},
      </if>
      <if test="familia != null">
        #{familia,jdbcType=VARCHAR},
      </if>
      <if test="familiaFin != null">
        #{familiaFin,jdbcType=VARCHAR},
      </if>
      <if test="calidad != null">
        #{calidad,jdbcType=VARCHAR},
      </if>
      <if test="calidadFin != null">
        #{calidadFin,jdbcType=VARCHAR},
      </if>
      <if test="variedad != null">
        #{variedad,jdbcType=VARCHAR},
      </if>
      <if test="variedadFin != null">
        #{variedadFin,jdbcType=VARCHAR},
      </if>
      <if test="usuCrea != null">
        #{usuCrea,jdbcType=INTEGER},
      </if>
      <if test="fechaCrea != null">
        #{fechaCrea,jdbcType=TIMESTAMP},
      </if>
      <if test="ggn != null">
        #{ggn,jdbcType=VARCHAR},
      </if>
      <if test="ggnFin != null">
        #{ggnFin,jdbcType=VARCHAR},
      </if>
      <if test="cerrada != null">
        #{cerrada,jdbcType=INTEGER},
      </if>
      <if test="calibre != null">
        #{calibre,jdbcType=VARCHAR},
      </if>
      <if test="calibreFin != null">
        #{calibreFin,jdbcType=VARCHAR},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.dina.genasoft.db.entity.TCompras2030">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    update t_compras_2030
    <set>
      <if test="idExterno != null">
        id_externo = #{idExterno,jdbcType=DOUBLE},
      </if>
      <if test="albaran != null">
        albaran = #{albaran,jdbcType=VARCHAR},
      </if>
      <if test="albaranFin != null">
        albaran_fin = #{albaranFin,jdbcType=VARCHAR},
      </if>
      <if test="lote != null">
        lote = #{lote,jdbcType=VARCHAR},
      </if>
      <if test="nombreDescriptivo != null">
        nombre_descriptivo = #{nombreDescriptivo,jdbcType=VARCHAR},
      </if>
      <if test="loteFin != null">
        lote_fin = #{loteFin,jdbcType=VARCHAR},
      </if>
      <if test="partida != null">
        partida = #{partida,jdbcType=VARCHAR},
      </if>
      <if test="partidaFin != null">
        partida_fin = #{partidaFin,jdbcType=VARCHAR},
      </if>
      <if test="fecha != null">
        fecha = #{fecha,jdbcType=DATE},
      </if>
      <if test="fechaFin != null">
        fecha_fin = #{fechaFin,jdbcType=DATE},
      </if>
      <if test="centro != null">
        centro = #{centro,jdbcType=VARCHAR},
      </if>
      <if test="centroFin != null">
        centro_fin = #{centroFin,jdbcType=VARCHAR},
      </if>
      <if test="cajas != null">
        cajas = #{cajas,jdbcType=INTEGER},
      </if>
      <if test="cajasFin != null">
        cajas_fin = #{cajasFin,jdbcType=INTEGER},
      </if>
      <if test="kgsBruto != null">
        kgs_bruto = #{kgsBruto,jdbcType=DOUBLE},
      </if>
      <if test="kgsBrutoFin != null">
        kgs_bruto_fin = #{kgsBrutoFin,jdbcType=DOUBLE},
      </if>
      <if test="tipoCompra != null">
        tipo_compra = #{tipoCompra,jdbcType=VARCHAR},
      </if>
      <if test="tipoCompraFin != null">
        tipo_compra_fin = #{tipoCompraFin,jdbcType=VARCHAR},
      </if>
      <if test="fechaCalibrado != null">
        fecha_calibrado = #{fechaCalibrado,jdbcType=TIMESTAMP},
      </if>
      <if test="fechaCalibradoFin != null">
        fecha_calibrado_fin = #{fechaCalibradoFin,jdbcType=TIMESTAMP},
      </if>
      <if test="pesoNeto != null">
        peso_neto = #{pesoNeto,jdbcType=DOUBLE},
      </if>
      <if test="pesoNetoFin != null">
        peso_neto_fin = #{pesoNetoFin,jdbcType=DOUBLE},
      </if>
      <if test="pesoNetoDisponible != null">
        peso_neto_disponible = #{pesoNetoDisponible,jdbcType=DOUBLE},
      </if>
      <if test="tara != null">
        tara = #{tara,jdbcType=DOUBLE},
      </if>
      <if test="taraFin != null">
        tara_fin = #{taraFin,jdbcType=DOUBLE},
      </if>
      <if test="finca != null">
        finca = #{finca,jdbcType=VARCHAR},
      </if>
      <if test="fincaFin != null">
        finca_fin = #{fincaFin,jdbcType=VARCHAR},
      </if>
      <if test="producto != null">
        producto = #{producto,jdbcType=VARCHAR},
      </if>
      <if test="productoFin != null">
        producto_fin = #{productoFin,jdbcType=VARCHAR},
      </if>
      <if test="proveedor != null">
        proveedor = #{proveedor,jdbcType=VARCHAR},
      </if>
      <if test="proveedorFin != null">
        proveedor_fin = #{proveedorFin,jdbcType=VARCHAR},
      </if>
      <if test="notasCalidad != null">
        notas_calidad = #{notasCalidad,jdbcType=VARCHAR},
      </if>
      <if test="notasCalidadFin != null">
        notas_calidad_fin = #{notasCalidadFin,jdbcType=VARCHAR},
      </if>
      <if test="origen != null">
        origen = #{origen,jdbcType=VARCHAR},
      </if>
      <if test="origenFin != null">
        origen_fin = #{origenFin,jdbcType=VARCHAR},
      </if>
      <if test="familia != null">
        familia = #{familia,jdbcType=VARCHAR},
      </if>
      <if test="familiaFin != null">
        familia_fin = #{familiaFin,jdbcType=VARCHAR},
      </if>
      <if test="calidad != null">
        calidad = #{calidad,jdbcType=VARCHAR},
      </if>
      <if test="calidadFin != null">
        calidad_fin = #{calidadFin,jdbcType=VARCHAR},
      </if>
      <if test="variedad != null">
        variedad = #{variedad,jdbcType=VARCHAR},
      </if>
      <if test="variedadFin != null">
        variedad_fin = #{variedadFin,jdbcType=VARCHAR},
      </if>
      <if test="usuCrea != null">
        usu_crea = #{usuCrea,jdbcType=INTEGER},
      </if>
      <if test="fechaCrea != null">
        fecha_crea = #{fechaCrea,jdbcType=TIMESTAMP},
      </if>
      <if test="ggn != null">
        ggn = #{ggn,jdbcType=VARCHAR},
      </if>
      <if test="ggnFin != null">
        ggn_fin = #{ggnFin,jdbcType=VARCHAR},
      </if>
      <if test="cerrada != null">
        cerrada = #{cerrada,jdbcType=INTEGER},
      </if>
      <if test="calibre != null">
        calibre = #{calibre,jdbcType=VARCHAR},
      </if>
      <if test="calibreFin != null">
        calibre_fin = #{calibreFin,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.dina.genasoft.db.entity.TCompras2030">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 24 13:49:39 CEST 2024.
    -->
    update t_compras_2030
    set id_externo = #{idExterno,jdbcType=DOUBLE},
      albaran = #{albaran,jdbcType=VARCHAR},
      albaran_fin = #{albaranFin,jdbcType=VARCHAR},
      lote = #{lote,jdbcType=VARCHAR},
      nombre_descriptivo = #{nombreDescriptivo,jdbcType=VARCHAR},
      lote_fin = #{loteFin,jdbcType=VARCHAR},
      partida = #{partida,jdbcType=VARCHAR},
      partida_fin = #{partidaFin,jdbcType=VARCHAR},
      fecha = #{fecha,jdbcType=DATE},
      fecha_fin = #{fechaFin,jdbcType=DATE},
      centro = #{centro,jdbcType=VARCHAR},
      centro_fin = #{centroFin,jdbcType=VARCHAR},
      cajas = #{cajas,jdbcType=INTEGER},
      cajas_fin = #{cajasFin,jdbcType=INTEGER},
      kgs_bruto = #{kgsBruto,jdbcType=DOUBLE},
      kgs_bruto_fin = #{kgsBrutoFin,jdbcType=DOUBLE},
      tipo_compra = #{tipoCompra,jdbcType=VARCHAR},
      tipo_compra_fin = #{tipoCompraFin,jdbcType=VARCHAR},
      fecha_calibrado = #{fechaCalibrado,jdbcType=TIMESTAMP},
      fecha_calibrado_fin = #{fechaCalibradoFin,jdbcType=TIMESTAMP},
      peso_neto = #{pesoNeto,jdbcType=DOUBLE},
      peso_neto_fin = #{pesoNetoFin,jdbcType=DOUBLE},
      peso_neto_disponible = #{pesoNetoDisponible,jdbcType=DOUBLE},
      tara = #{tara,jdbcType=DOUBLE},
      tara_fin = #{taraFin,jdbcType=DOUBLE},
      finca = #{finca,jdbcType=VARCHAR},
      finca_fin = #{fincaFin,jdbcType=VARCHAR},
      producto = #{producto,jdbcType=VARCHAR},
      producto_fin = #{productoFin,jdbcType=VARCHAR},
      proveedor = #{proveedor,jdbcType=VARCHAR},
      proveedor_fin = #{proveedorFin,jdbcType=VARCHAR},
      notas_calidad = #{notasCalidad,jdbcType=VARCHAR},
      notas_calidad_fin = #{notasCalidadFin,jdbcType=VARCHAR},
      origen = #{origen,jdbcType=VARCHAR},
      origen_fin = #{origenFin,jdbcType=VARCHAR},
      familia = #{familia,jdbcType=VARCHAR},
      familia_fin = #{familiaFin,jdbcType=VARCHAR},
      calidad = #{calidad,jdbcType=VARCHAR},
      calidad_fin = #{calidadFin,jdbcType=VARCHAR},
      variedad = #{variedad,jdbcType=VARCHAR},
      variedad_fin = #{variedadFin,jdbcType=VARCHAR},
      usu_crea = #{usuCrea,jdbcType=INTEGER},
      fecha_crea = #{fechaCrea,jdbcType=TIMESTAMP},
      ggn = #{ggn,jdbcType=VARCHAR},
      ggn_fin = #{ggnFin,jdbcType=VARCHAR},
      cerrada = #{cerrada,jdbcType=INTEGER},
      calibre = #{calibre,jdbcType=VARCHAR},
      calibre_fin = #{calibreFin,jdbcType=VARCHAR}
    where id = #{id,jdbcType=INTEGER}
  </update>
  
  <select id="obtenerCompraPorAlbaranLote" resultMap="BaseResultMap2">
    <!--
     
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where 
    	albaran = #{albaran,jdbcType=VARCHAR}
    AND
    	lote = #{lote,jdbcType=VARCHAR}
  </select>
  
  <insert id="insertRecord" keyColumn="id" keyProperty="id" parameterType="map" useGeneratedKeys="true">
   <!-- 
   		Elemento que nos crea la familia y nos retorna el ID generado
    -->
    insert into t_compras_2030 (id_externo, albaran, 
      albaran_fin, lote, nombre_descriptivo, 
      lote_fin, partida, partida_fin, 
      fecha, fecha_fin, centro, 
      centro_fin, cajas, cajas_fin, 
      kgs_bruto, kgs_bruto_fin, tipo_compra, 
      tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, 
      peso_neto, peso_neto_fin, peso_neto_disponible, 
      tara, tara_fin, finca, 
      finca_fin, producto, producto_fin, 
      proveedor, proveedor_fin, notas_calidad, 
      notas_calidad_fin, origen, origen_fin, 
      familia, familia_fin, calidad, 
      calidad_fin, variedad, variedad_fin, 
      usu_crea, fecha_crea, ggn, 
      ggn_fin, cerrada, calibre, 
      calibre_fin)
    values (#{idExterno,jdbcType=DOUBLE}, #{albaran,jdbcType=VARCHAR}, 
      #{albaranFin,jdbcType=VARCHAR}, #{lote,jdbcType=VARCHAR}, #{nombreDescriptivo,jdbcType=VARCHAR}, 
      #{loteFin,jdbcType=VARCHAR}, #{partida,jdbcType=VARCHAR}, #{partidaFin,jdbcType=VARCHAR}, 
      #{fecha,jdbcType=DATE}, #{fechaFin,jdbcType=DATE}, #{centro,jdbcType=VARCHAR}, 
      #{centroFin,jdbcType=VARCHAR}, #{cajas,jdbcType=INTEGER}, #{cajasFin,jdbcType=INTEGER}, 
      #{kgsBruto,jdbcType=DOUBLE}, #{kgsBrutoFin,jdbcType=DOUBLE}, #{tipoCompra,jdbcType=VARCHAR}, 
      #{tipoCompraFin,jdbcType=VARCHAR}, #{fechaCalibrado,jdbcType=TIMESTAMP}, #{fechaCalibradoFin,jdbcType=TIMESTAMP}, 
      #{pesoNeto,jdbcType=DOUBLE}, #{pesoNetoFin,jdbcType=DOUBLE}, #{pesoNetoDisponible,jdbcType=DOUBLE}, 
      #{tara,jdbcType=DOUBLE}, #{taraFin,jdbcType=DOUBLE}, #{finca,jdbcType=VARCHAR}, 
      #{fincaFin,jdbcType=VARCHAR}, #{producto,jdbcType=VARCHAR}, #{productoFin,jdbcType=VARCHAR}, 
      #{proveedor,jdbcType=VARCHAR}, #{proveedorFin,jdbcType=VARCHAR}, #{notasCalidad,jdbcType=VARCHAR}, 
      #{notasCalidadFin,jdbcType=VARCHAR}, #{origen,jdbcType=VARCHAR}, #{origenFin,jdbcType=VARCHAR}, 
      #{familia,jdbcType=VARCHAR}, #{familiaFin,jdbcType=VARCHAR}, #{calidad,jdbcType=VARCHAR}, 
      #{calidadFin,jdbcType=VARCHAR}, #{variedad,jdbcType=VARCHAR}, #{variedadFin,jdbcType=VARCHAR}, 
      #{usuCrea,jdbcType=INTEGER}, #{fechaCrea,jdbcType=TIMESTAMP}, #{ggn,jdbcType=VARCHAR}, 
      #{ggnFin,jdbcType=VARCHAR}, #{cerrada,jdbcType=INTEGER}, #{calibre,jdbcType=VARCHAR}, 
      #{calibreFin,jdbcType=VARCHAR})
   </insert>
   
   <select id="obtenerTodasCompras" parameterType="java.lang.Integer" resultMap="BaseResultMap2">
    <!--
      
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    order by fecha_fin, lote_fin
  </select>
  
  <select id="obtenerTodasCompras2" parameterType="java.lang.Integer" resultMap="BaseResultMap2">
    <!--
      
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    <![CDATA[ 
    	where kgs_netos_fin > 0
    ]]>
    order by fecha_fin, lote_fin    
  </select>
  
  
  
  <select id="obtenerComprasIds" parameterType="java.lang.Integer" resultMap="BaseResultMap2">
    <!--
      Elemento que nos retorna las compras que cumplen la condicion
    -->
   select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where 
      id in
      		<foreach close=")" collection="list" index="index" item="item" open="(" separator=",">
          						#{item}
    			</foreach>
    order by fecha_fin, lote_fin    
  </select>
  
  
  <update id="cerrarComprasKgsDisponiblesCero" parameterType="java.lang.Integer">
    <!--
     
    -->
    update t_compras_2030
    set peso_neto_disponible = 0,
    cerrada = 1      
    where id in
    	<foreach close=")" collection="list" index="index" item="item" open="(" separator=",">
          						#{item}
    			</foreach>
  </update>
  
   <delete id="eliminarComprasIds" parameterType="java.lang.Integer">
    <!--
      
    -->
    delete from t_compras_2030
    where id in
    	<foreach close=")" collection="list" index="index" item="item" open="(" separator=",">
          						#{item}
    	</foreach>
  </delete>
  
  <select id="obtenerComprasParametros" parameterType="java.lang.Integer" resultMap="BaseResultMap2">
    <!--
      Elemento que nos retorna las compras que cumplen la condicion
    -->
   SELECT id, albaran, albaran_fin, lote, nombre_descriptivo, lote_fin, partida, partida_fin, 
    fecha, fecha_fin, centro, centro_fin, cajas, cajas_fin, kgs_bruto, kgs_bruto_fin, 
    tipo_compra, tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, peso_neto, 
    peso_neto_disponible, tara, tara_fin, finca, finca_fin, producto, producto_fin, proveedor, 
    proveedor_fin, notas_calidad, notas_calidad_fin, origen, origen_fin, familia, familia_fin, 
    calidad, calidad_fin, variedad, variedad_fin, usu_crea, fecha_crea, ggn, ggn_fin, 
    cerrada, sum(peso_neto_fin) as peso_neto_fin from t_compras_2030
    where 
    	id > 0
      <if test="f1 != null and f2 !=null">
        	AND
        	<![CDATA[ 
        		fecha_fin >= #{f1,jdbcType=DATE} 
        	]]>
        	AND
        	<![CDATA[ 
        		fecha_fin <= #{f2,jdbcType=DATE} 
        	]]>
      </if>
      <if test="f1 != null and f2 ==null">
        	AND
        	<![CDATA[ 
        		fecha_fin >= #{f1,jdbcType=DATE} 
        	]]>
      </if>
      <if test="f1 == null and f2 !=null">        	
        	AND
        	<![CDATA[ 
        		fecha_fin <= #{f2,jdbcType=DATE} 
        	]]>
      </if>
       <if test="producto !=null and producto != 'DESGLOSADO'">        	
        	AND
        		familia_fin = #{producto,jdbcType=VARCHAR}         	
      </if>
      <if test="calidad !=null">        	
        	AND
        		calidad_fin = #{calidad,jdbcType=VARCHAR}         	
      </if>
      <if test="origen !=null and origen == 'ESPAÑA' and origen != 'DESGLOSADO'">        	
        	AND
        		origen_fin = 'ESPAÑA'        	
      </if>
      <if test="origen !=null and origen != 'ESPAÑA' and origen != 'DESGLOSADO' ">        	
        	AND
        	<![CDATA[ 
        		origen_fin <> 'ESPAÑA'   
        	]]>     	
      </if>
      <if test="ggn != null and ggn == 'Sí'">
      		AND
    		ggn = 'GGN NACIONAL'
    </if>
    <if test="ggn != null and ggn == 'No'">
    	AND
    		ggn = 'NO GG'
    </if>
      <if test="producto == null and calidad2 == null and origen2 == null or producto == 'DESGLOSADO' ">
      		GROUP BY familia_fin, variedad_fin
      </if>
      <if test="producto == null and calidad2 == null and origen2 != null">
      		GROUP BY familia_fin, variedad_fin, origen_fin
      </if>
      <if test="producto == null and calidad2 != null and origen2 != null">
      		GROUP BY familia_fin, variedad_fin, origen_fin, calidad_fin
      </if>
      <if test="producto == null and calidad2 != null and origen2 == null">
      		GROUP BY familia_fin, variedad_fin, calidad_fin
      </if>
      
      
      
  </select>
  
  <insert id="insertarComprasMasivo" parameterType="java.util.List">
   INSERT     
     INTO t_compras_2030 (albaran, albaran_fin, lote, nombre_descriptivo, lote_fin, partida, partida_fin, 
    fecha, fecha_fin, centro, centro_fin, cajas, cajas_fin, kgs_bruto, kgs_bruto_fin, 
    tipo_compra, tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, peso_neto, peso_neto_fin, 
    peso_neto_disponible, tara, tara_fin, finca, finca_fin, producto, producto_fin, proveedor, 
    proveedor_fin, notas_calidad, notas_calidad_fin, origen, origen_fin, familia, familia_fin, 
    calidad, calidad_fin, variedad, variedad_fin, usu_crea, fecha_crea, ggn, ggn_fin, 
    cerrada, calibre, calibre_fin) values
     <foreach collection="list" index="index" item="element" separator=",">
      (#{element.albaran},#{element.albaranFin},#{element.lote},#{element.nombreDescriptivo},#{element.loteFin},#{element.partida},#{element.partidaFin}
    ,#{element.fecha},#{element.fechaFin},#{element.centro},#{element.centroFin},#{element.cajas},#{element.cajasFin},#{element.kgsBruto},#{element.kgsBrutoFin}
    ,#{element.tipoCompra},#{element.tipoCompraFin},#{element.fechaCalibrado},#{element.fechaCalibradoFin},#{element.pesoNeto},#{element.pesoNetoFin}
    ,#{element.pesoNetoDisponible},#{element.tara},#{element.taraFin},#{element.finca},#{element.fincaFin},#{element.producto},#{element.productoFin},#{element.proveedor}
    ,#{element.proveedorFin},#{element.notasCalidad},#{element.notasCalidadFin},#{element.origen},#{element.origenFin},#{element.familia},#{element.familiaFin}
    ,#{element.calidad},#{element.calidadFin},#{element.variedad},#{element.variedadFin},#{element.usuCrea},#{element.fechaCrea},#{element.ggn},#{element.ggnFin},#{element.cerrada},#{element.calibre},#{element.calibreFin})
    </foreach>
  
 </insert>
 
 <select id="obtenerComprasAlbaranesLotesPartidas" resultMap="BaseResultMap2">
    <!--
      Elemento que nos retorna las compras que cumplen la condicion
    -->
   select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where 
    <if test="list != null">
      albaran_fin in
      		<foreach close=")" collection="list" index="index" item="item" open="(" separator=",">
          						#{item}
    			</foreach>		
      </if>
      <if test="list != null and list2 != null">
      AND
      lote_fin in
      		<foreach close=")" collection="list2" index="index" item="item" open="(" separator=",">
          						#{item}
    			</foreach>		
      </if>
      <if test="list == null and list2 != null">      
      lote_fin in
      		<foreach close=")" collection="list2" index="index" item="item" open="(" separator=",">
          						#{item}
    			</foreach>		
      </if>
      	<if test="list3 != null">
	       <if test="list != null or list2 != null">
		       AND
		      partida_fin in
		      		<foreach close=")" collection="list3" index="index" item="item" open="(" separator=",">
		          						#{item}
		    			</foreach>		
	      </if>
	       <if test="list == null and list2 == null and list3 != null">	       
		      partida_fin in
		      		<foreach close=")" collection="list3" index="index" item="item" open="(" separator=",">
		          						#{item}
		    			</foreach>		
	      </if>
      </if>
      
      
    order by fecha_fin, lote_fin    
  </select>
  
  
  <select id="obtenerCompraPorIdExterno" parameterType="java.lang.Double" resultMap="BaseResultMap2">
    <!--
      
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where
    	id_externo = #{idExterno,jdbcType=DOUBLE}
  </select>
  
  <select id="obtenerCompraPorLote" resultMap="BaseResultMap2">
    <!--
     
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where     	
    	partida_fin = #{lote,jdbcType=VARCHAR}    
  </select>
  
  
  <select id="obtenerCompraPorLotePartida" resultMap="BaseResultMap2">
    <!--
     
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where     	
    	lote = #{lote,jdbcType=VARCHAR}
    AND
    	partida_fin = #{partida,jdbcType=VARCHAR}
  </select>
  
  
  <select id="obtenerComprasParametros2" resultMap="BaseResultMap2">
    <!--
     
    -->
    select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where     	 
        <![CDATA[ 
        		fecha_fin >= #{f1,jdbcType=DATE} 
        	]]>
        AND
        	<![CDATA[ 
        		fecha_fin <= #{f2,jdbcType=DATE} 
        	]]>
       and variedad_fin in 
       		<foreach close=")" collection="list" index="index" item="item" open="(" separator=",">
		          						#{item}
		   </foreach>
		<if test="origen != null"> 
		AND
			origen_fin = #{origen,jdbcType=VARCHAR}
		</if>
		<if test="calidad != null">
		AND
			calidad_fin = #{calidad,jdbcType=VARCHAR}
		</if>
		AND 
			cerrada = 0
  </select>
  
  <select id="obtenerComprasBalanceMasasTodosGroupBy" resultMap="BaseResultMap2">
    <!--
     
    -->
    SELECT id, albaran, albaran_fin, lote, nombre_descriptivo, lote_fin, partida, partida_fin, 
    fecha, fecha_fin, centro, centro_fin, cajas, cajas_fin, kgs_bruto, kgs_bruto_fin, 
    tipo_compra, tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, peso_neto, 
    peso_neto_disponible, tara, tara_fin, finca, finca_fin, producto, producto_fin, proveedor, 
    proveedor_fin, notas_calidad, notas_calidad_fin, origen, origen_fin, familia, familia_fin, 
    calidad, calidad_fin, variedad, variedad_fin, usu_crea, fecha_crea, ggn, ggn_fin, 
    cerrada, sum(peso_neto_fin) as peso_neto_fin 
    FROM 
    	t_compras_2030 
    GROUP BY 
    	origen_fin, familia_fin, calidad_fin, origen_fin, ggn_fin;
  </select>
  
  
  
  <select id="obtenerComprasCertificacionNacionalImportacion" resultMap="BaseResultMap2">
    <!--
     
    -->
    SELECT id, albaran, albaran_fin, lote, nombre_descriptivo, lote_fin, partida, partida_fin, 
    fecha, fecha_fin, centro, centro_fin, cajas, cajas_fin, kgs_bruto, kgs_bruto_fin, 
    tipo_compra, tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, peso_neto, 
    peso_neto_disponible, tara, tara_fin, finca, finca_fin, producto, producto_fin, proveedor, 
    proveedor_fin, notas_calidad, notas_calidad_fin, origen, origen_fin, familia, familia_fin, 
    calidad, calidad_fin, variedad, variedad_fin, usu_crea, fecha_crea, ggn, ggn_fin, 
    cerrada, sum(peso_neto_fin) as peso_neto_fin 
    FROM 
    	t_compras_2030 
    GROUP BY 
    	familia_fin, calidad_fin, origen_fin
  </select>

   <select id="obtenerComprasGlobalGap" resultMap="BaseResultMap2">
    <!--
     
    -->
    SELECT id, albaran, albaran_fin, lote, nombre_descriptivo, lote_fin, partida, partida_fin, 
    fecha, fecha_fin, centro, centro_fin, cajas, cajas_fin, kgs_bruto, kgs_bruto_fin, 
    tipo_compra, tipo_compra_fin, fecha_calibrado, fecha_calibrado_fin, peso_neto, 
    peso_neto_disponible, tara, tara_fin, finca, finca_fin, producto, producto_fin, proveedor, 
    proveedor_fin, notas_calidad, notas_calidad_fin, origen, origen_fin, familia, familia_fin, 
    calidad, calidad_fin, variedad, variedad_fin, usu_crea, fecha_crea, ggn, ggn_fin, 
    cerrada, sum(peso_neto_fin) as peso_neto_fin 
    FROM 
    	t_compras_2030 
    WHERE 
    	  <![CDATA[ 
    	calidad_fin <> 'CONVENCIONAL'
     ]]>
    GROUP BY 
    	familia_fin, origen_fin
  </select>
  
  <select id="obtenerFechasComprasDisponibles" resultType="java.lang.Integer">
    <!--
     
    -->
    	SELECT distinct year(fecha) AS fecha FROM t_compras_2030
  </select>
  <select id="obtenerComprasFechas" parameterType="java.lang.Integer" resultMap="BaseResultMap2">
    <!--
      Elemento que nos retorna las compras que cumplen la condicion
    -->
   select 'false' as QUERYID,
    <include refid="Base_Column_List" />
    from t_compras_2030
    where  
    	id > 0
      <if test="f1 != null and f2 !=null">
        	AND
        	<![CDATA[ 
        		fecha_fin >= #{f1,jdbcType=DATE} 
        	]]>
        	AND
        	<![CDATA[ 
        		fecha_fin <= #{f2,jdbcType=DATE} 
        	]]>
      </if>
      <if test="f1 != null and f2 ==null">
        	AND
        	<![CDATA[ 
        		fecha_fin >= #{f1,jdbcType=DATE} 
        	]]>
      </if>
      <if test="f1 == null and f2 !=null">        	
        	AND
        	<![CDATA[ 
        		fecha_fin <= #{f2,jdbcType=DATE} 
        	]]>
      </if>
       <if test="producto !=null and producto != 'DESGLOSADO'">        	
        	AND
        		familia_fin = #{producto,jdbcType=VARCHAR}         	
      </if>
      <if test="calidad !=null">        	
        	AND
        		calidad_fin = #{calidad,jdbcType=VARCHAR}         	
      </if>
      <if test="origen !=null and origen == 'ESPAÑA' and origen != 'DESGLOSADO'">        	
        	AND
        		origen_fin = 'ESPAÑA'        	
      </if>
      <if test="origen !=null and origen != 'ESPAÑA' and origen != 'DESGLOSADO' ">        	
        	AND
        	<![CDATA[ 
        		origen_fin <> 'ESPAÑA'   
        	]]>     	
      </if>
      <if test="ggn != null and ggn == 'Sí'">
      		AND
    		ggn = 'GGN NACIONAL'
    </if>
    <if test="ggn != null and ggn == 'No'">
    	AND
    		ggn = 'NO GG'
    </if>
      <if test="producto == null and calidad2 == null and origen2 == null or producto == 'DESGLOSADO' ">
      		GROUP BY familia_fin, variedad_fin
      </if>
      <if test="producto == null and calidad2 == null and origen2 != null">
      		GROUP BY familia_fin, variedad_fin, origen_fin
      </if>
      <if test="producto == null and calidad2 != null and origen2 != null">
      		GROUP BY familia_fin, variedad_fin, origen_fin, calidad_fin
      </if>
      <if test="producto == null and calidad2 != null and origen2 == null">
      		GROUP BY familia_fin, variedad_fin, calidad_fin
      </if>

  </select>
</mapper>